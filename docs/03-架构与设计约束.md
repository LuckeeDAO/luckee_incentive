# Luckee Incentive æ¶æ„ä¸è®¾è®¡çº¦æŸ

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

- **é¡¹ç›®åç§°**: Luckee Incentive (æ¿€åŠ±åˆçº¦)
- **ç‰ˆæœ¬**: v1.0
- **æ–‡æ¡£ç±»å‹**: æ¶æ„ä¸è®¾è®¡çº¦æŸ
- **åˆ›å»ºæ—¥æœŸ**: 2024-01-XX
- **æœ€åæ›´æ–°**: 2024-01-XX

## ğŸ¯ æ¦‚è¿°

æœ¬æ–‡æ¡£æ˜ç¡®æŒ‡å®šLuckee Incentiveåˆçº¦å¿…é¡»ä½¿ç”¨çš„æŠ€æœ¯æ ˆã€æ¡†æ¶ã€è®¾è®¡æ¨¡å¼ã€ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œä»¥åŠæ˜ç¡®çš„ç¦æ­¢é¡¹ã€‚çº¦æŸAIçš„è®¾è®¡ç©ºé—´ï¼Œç¡®ä¿æŠ€æœ¯æ–¹æ¡ˆç¬¦åˆå›¢é˜Ÿæˆ˜ç•¥ã€å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§è¦æ±‚ã€‚

## ğŸ› ï¸ å¿…éœ€æŠ€æœ¯æ ˆ

### 1. æ ¸å¿ƒæ¡†æ¶

```yaml
required_frameworks:
  cosmwasm:
    version: ">= 1.4.0"
    description: "CosmWasmæ™ºèƒ½åˆçº¦æ¡†æ¶"
    usage: "åˆçº¦å¼€å‘åŸºç¡€æ¡†æ¶"
    alternatives: "ä¸å…è®¸ä½¿ç”¨å…¶ä»–æ™ºèƒ½åˆçº¦æ¡†æ¶"
    
  rust:
    version: ">= 1.70.0"
    description: "Rustç¼–ç¨‹è¯­è¨€"
    usage: "åˆçº¦å¼€å‘è¯­è¨€"
    alternatives: "ä¸å…è®¸ä½¿ç”¨å…¶ä»–è¯­è¨€"
    
  cosmwasm-std:
    version: ">= 1.4.0"
    description: "CosmWasmæ ‡å‡†åº“"
    usage: "æä¾›åŸºç¡€ç±»å‹å’Œå‡½æ•°"
    alternatives: "ä¸å…è®¸ä½¿ç”¨å…¶ä»–æ ‡å‡†åº“"
```

### 2. å­˜å‚¨æ¡†æ¶

```yaml
storage_frameworks:
  cw-storage-plus:
    version: ">= 1.1.0"
    description: "CosmWasmå­˜å‚¨å¢å¼ºåº“"
    usage: "æä¾›Mapã€Itemç­‰é«˜çº§å­˜å‚¨ç»“æ„"
    alternatives: "ä¸å…è®¸ä½¿ç”¨åŸç”Ÿå­˜å‚¨"
    
  cosmwasm-storage:
    version: ">= 1.4.0"
    description: "CosmWasmå­˜å‚¨åº“"
    usage: "åŸºç¡€å­˜å‚¨åŠŸèƒ½"
    alternatives: "ä¸å…è®¸ä½¿ç”¨å…¶ä»–å­˜å‚¨åº“"
```

### 3. åºåˆ—åŒ–æ¡†æ¶

```yaml
serialization_frameworks:
  serde:
    version: ">= 1.0.0"
    description: "åºåˆ—åŒ–/ååºåˆ—åŒ–æ¡†æ¶"
    usage: "æ¶ˆæ¯å’ŒçŠ¶æ€åºåˆ—åŒ–"
    alternatives: "ä¸å…è®¸ä½¿ç”¨å…¶ä»–åºåˆ—åŒ–åº“"
    
  cosmwasm-schema:
    version: ">= 1.4.0"
    description: "CosmWasmæ¨¡å¼ç”Ÿæˆ"
    usage: "ç”ŸæˆJSON Schema"
    alternatives: "ä¸å…è®¸ä½¿ç”¨å…¶ä»–æ¨¡å¼ç”Ÿæˆå·¥å…·"
```

## ğŸ—ï¸ è®¾è®¡æ¨¡å¼çº¦æŸ

### 1. å¿…éœ€è®¾è®¡æ¨¡å¼

```yaml
required_patterns:
  state_pattern:
    description: "çŠ¶æ€ç®¡ç†æ¨¡å¼"
    implementation: "ä½¿ç”¨cw-storage-plusçš„Mapå’ŒItem"
    example: |
      use cw_storage_plus::{Map, Item};
      
      pub const REWARD_HISTORY: Map<&Addr, Vec<RewardRecord>> = Map::new("reward_history");
      pub const CONFIG: Item<Config> = Item::new("config");
      pub const REGISTERED_CONTRACTS: Map<&Addr, ContractInfo> = Map::new("registered_contracts");
    
  error_pattern:
    description: "é”™è¯¯å¤„ç†æ¨¡å¼"
    implementation: "ä½¿ç”¨thiserrorå®šä¹‰è‡ªå®šä¹‰é”™è¯¯"
    example: |
      use thiserror::Error;
      
      #[derive(Error, Debug, PartialEq)]
      pub enum ContractError {
          #[error("Unauthorized")]
          Unauthorized,
          #[error("User not found")]
          UserNotFound,
          #[error("Unsupported activity type")]
          UnsupportedActivity,
      }
    
  message_pattern:
    description: "æ¶ˆæ¯æ¨¡å¼"
    implementation: "ä½¿ç”¨serdeåºåˆ—åŒ–çš„æ¶ˆæ¯ç»“æ„"
    example: |
      use serde::{Deserialize, Serialize};
      
      #[derive(Serialize, Deserialize, Clone, Debug, PartialEq)]
      pub struct InstantiateMsg {
          pub admin: String,
          pub ft_contract: String,
          pub registry_contract: String,
          pub config: ContractConfig,
      }
```

### 2. æ¨èè®¾è®¡æ¨¡å¼

```yaml
recommended_patterns:
  factory_pattern:
    description: "å·¥å‚æ¨¡å¼"
    usage: "åˆ›å»ºå¥–åŠ±è®°å½•å®ä¾‹"
    implementation: "ä½¿ç”¨new()æ–¹æ³•åˆ›å»ºç»“æ„ä½“"
    
  strategy_pattern:
    description: "ç­–ç•¥æ¨¡å¼"
    usage: "ä¸åŒæ´»åŠ¨ç±»å‹çš„å¥–åŠ±è®¡ç®—ç­–ç•¥"
    implementation: "ä½¿ç”¨traitå®šä¹‰è®¡ç®—ç­–ç•¥"
    
  observer_pattern:
    description: "è§‚å¯Ÿè€…æ¨¡å¼"
    usage: "äº‹ä»¶é€šçŸ¥æœºåˆ¶"
    implementation: "ä½¿ç”¨CosmWasmäº‹ä»¶ç³»ç»Ÿ"
    
  facade_pattern:
    description: "å¤–è§‚æ¨¡å¼"
    usage: "ç®€åŒ–ä¸å…¶ä»–åˆçº¦çš„äº¤äº’"
    implementation: "æä¾›ç»Ÿä¸€çš„æ¥å£è°ƒç”¨å…¶ä»–åˆçº¦"
```

## ğŸš« æ˜ç¡®ç¦æ­¢é¡¹

### 1. ç¦æ­¢ä½¿ç”¨çš„åº“

```yaml
prohibited_libraries:
  unsafe_libraries:
    - "std::ptr"
    - "std::mem::transmute"
    - "std::mem::forget"
    description: "ç¦æ­¢ä½¿ç”¨unsafeä»£ç "
    reason: "æ™ºèƒ½åˆçº¦å®‰å…¨è¦æ±‚"
    
  external_crates:
    - "tokio"
    - "async-std"
    - "futures"
    description: "ç¦æ­¢ä½¿ç”¨å¼‚æ­¥è¿è¡Œæ—¶"
    reason: "CosmWasmä¸æ”¯æŒå¼‚æ­¥"
    
  network_crates:
    - "reqwest"
    - "hyper"
    - "curl"
    description: "ç¦æ­¢ä½¿ç”¨ç½‘ç»œè¯·æ±‚åº“"
    reason: "æ™ºèƒ½åˆçº¦ä¸èƒ½å‘èµ·å¤–éƒ¨è¯·æ±‚"
    
  file_system_crates:
    - "std::fs"
    - "std::path"
    - "walkdir"
    description: "ç¦æ­¢ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿæ“ä½œ"
    reason: "æ™ºèƒ½åˆçº¦æ— æ–‡ä»¶ç³»ç»Ÿè®¿é—®æƒé™"
    
  random_crates:
    - "rand"
    - "fastrand"
    description: "ç¦æ­¢ä½¿ç”¨éšæœºæ•°ç”Ÿæˆå™¨"
    reason: "æ™ºèƒ½åˆçº¦éœ€è¦ç¡®å®šæ€§æ‰§è¡Œ"
```

### 2. ç¦æ­¢çš„è®¾è®¡æ¨¡å¼

```yaml
prohibited_patterns:
  singleton_pattern:
    description: "ç¦æ­¢å•ä¾‹æ¨¡å¼"
    reason: "æ™ºèƒ½åˆçº¦çŠ¶æ€æ˜¯å…¨å±€çš„"
    
  mutable_global_state:
    description: "ç¦æ­¢å¯å˜å…¨å±€çŠ¶æ€"
    reason: "ä½¿ç”¨CosmWasmå­˜å‚¨ç³»ç»Ÿ"
    
  recursive_calls:
    description: "ç¦æ­¢é€’å½’è°ƒç”¨"
    reason: "å¯èƒ½å¯¼è‡´æ ˆæº¢å‡º"
    
  infinite_loops:
    description: "ç¦æ­¢æ— é™å¾ªç¯"
    reason: "å¯èƒ½å¯¼è‡´Gasè€—å°½"
```

### 3. ç¦æ­¢çš„ç¼–ç¨‹å®è·µ

```yaml
prohibited_practices:
  panic_usage:
    description: "ç¦æ­¢ä½¿ç”¨panic!"
    reason: "ä¼šå¯¼è‡´åˆçº¦æ‰§è¡Œå¤±è´¥"
    alternative: "ä½¿ç”¨Resultç±»å‹å¤„ç†é”™è¯¯"
    
  unwrap_usage:
    description: "ç¦æ­¢ä½¿ç”¨unwrap()"
    reason: "å¯èƒ½å¯¼è‡´panic"
    alternative: "ä½¿ç”¨expect()æˆ–matchå¤„ç†"
    
  clone_excessive:
    description: "ç¦æ­¢è¿‡åº¦ä½¿ç”¨clone()"
    reason: "å½±å“æ€§èƒ½å’ŒGasæ¶ˆè€—"
    alternative: "ä½¿ç”¨å¼•ç”¨æˆ–ç§»åŠ¨è¯­ä¹‰"
    
  string_concatenation:
    description: "ç¦æ­¢å­—ç¬¦ä¸²æ‹¼æ¥"
    reason: "å½±å“æ€§èƒ½"
    alternative: "ä½¿ç”¨format!å®"
```

## ğŸ”§ ç¬¬ä¸‰æ–¹æœåŠ¡çº¦æŸ

### 1. å…è®¸çš„æœåŠ¡

```yaml
allowed_services:
  cosmwasm_services:
    - "cosmwasm-std"
    - "cw-storage-plus"
    - "cw-utils"
    description: "CosmWasmå®˜æ–¹æœåŠ¡"
    
  serde_services:
    - "serde"
    - "serde_json"
    description: "åºåˆ—åŒ–æœåŠ¡"
    
  thiserror_service:
    - "thiserror"
    description: "é”™è¯¯å¤„ç†æœåŠ¡"
```

### 2. ç¦æ­¢çš„æœåŠ¡

```yaml
prohibited_services:
  external_apis:
    - "HTTP APIs"
    - "REST APIs"
    - "GraphQL APIs"
    description: "ç¦æ­¢å¤–éƒ¨APIè°ƒç”¨"
    reason: "æ™ºèƒ½åˆçº¦ä¸èƒ½å‘èµ·å¤–éƒ¨è¯·æ±‚"
    
  databases:
    - "PostgreSQL"
    - "MySQL"
    - "MongoDB"
    - "Redis"
    description: "ç¦æ­¢å¤–éƒ¨æ•°æ®åº“"
    reason: "ä½¿ç”¨CosmWasmå­˜å‚¨ç³»ç»Ÿ"
    
  message_queues:
    - "RabbitMQ"
    - "Kafka"
    - "Redis Pub/Sub"
    description: "ç¦æ­¢æ¶ˆæ¯é˜Ÿåˆ—"
    reason: "æ™ºèƒ½åˆçº¦æ— å¤–éƒ¨é€šä¿¡èƒ½åŠ›"
```

## ğŸ“ æ€§èƒ½çº¦æŸ

### 1. Gasä½¿ç”¨é™åˆ¶

```yaml
gas_constraints:
  max_gas_per_operation:
    distribute_reward: 130000
    mint_for_points: 90000
    update_rules: 50000
    register_contract: 30000
    query_operations: 18000
    description: "æ¯ä¸ªæ“ä½œçš„æœ€å¤§Gasä½¿ç”¨é‡"
    
  optimization_requirements:
    - "ä½¿ç”¨æ‰¹é‡æ“ä½œå‡å°‘äº¤æ˜“æ•°é‡"
    - "ä¼˜åŒ–å­˜å‚¨ç»“æ„å‡å°‘è¯»å†™æ¬¡æ•°"
    - "ä½¿ç”¨ç´¢å¼•æé«˜æŸ¥è¯¢æ•ˆç‡"
    - "ç¼“å­˜å¸¸ç”¨æ•°æ®é¿å…é‡å¤è®¡ç®—"
```

### 2. å­˜å‚¨é™åˆ¶

```yaml
storage_constraints:
  max_reward_records_per_user:
    size: "10KB"
    description: "æ¯ä¸ªç”¨æˆ·çš„æœ€å¤§å¥–åŠ±è®°å½•å­˜å‚¨ç©ºé—´"
    
  max_registered_contracts:
    count: 100
    description: "æœ€å¤§æ³¨å†Œåˆçº¦æ•°é‡"
    
  storage_optimization:
    - "ä½¿ç”¨å‹ç¼©å­˜å‚¨"
    - "é¿å…å†—ä½™æ•°æ®"
    - "å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®"
```

## ğŸ”’ å®‰å…¨çº¦æŸ

### 1. è®¿é—®æ§åˆ¶

```yaml
access_control:
  admin_functions:
    - "update_config"
    - "emergency_pause"
    - "update_rules"
    - "register_contract"
    description: "åªæœ‰ç®¡ç†å‘˜å¯ä»¥è°ƒç”¨"
    
  user_functions:
    - "query_own_reward_history"
    - "query_own_stats"
    description: "ç”¨æˆ·åªèƒ½æŸ¥è¯¢è‡ªå·±çš„ä¿¡æ¯"
    
  contract_functions:
    - "distribute_reward"
    - "mint_for_points"
    - "query_user_points"
    description: "åªæœ‰æ³¨å†Œçš„åˆçº¦å¯ä»¥è°ƒç”¨"
```

### 2. è¾“å…¥éªŒè¯

```yaml
input_validation:
  address_validation:
    pattern: "^luckee[a-z0-9]{38}$"
    description: "åœ°å€æ ¼å¼éªŒè¯"
    
  points_validation:
    min: "1000"
    max: "1000000000000000000"
    pattern: "^[0-9]+$"
    description: "ç§¯åˆ†æ•°é‡éªŒè¯"
    
  activity_type_validation:
    enum: ["blind_box_open", "nft_mint", "voting", "referral_reward", "special_event"]
    description: "æ´»åŠ¨ç±»å‹éªŒè¯"
    
  string_validation:
    max_length: 1000
    description: "å­—ç¬¦ä¸²é•¿åº¦é™åˆ¶"
```

## ğŸ§ª æµ‹è¯•çº¦æŸ

### 1. æµ‹è¯•æ¡†æ¶

```yaml
testing_frameworks:
  cosmwasm-testing:
    version: ">= 1.4.0"
    description: "CosmWasmæµ‹è¯•æ¡†æ¶"
    usage: "åˆçº¦æµ‹è¯•"
    
  cw-multi-test:
    version: ">= 0.16.0"
    description: "å¤šåˆçº¦æµ‹è¯•æ¡†æ¶"
    usage: "é›†æˆæµ‹è¯•"
```

### 2. æµ‹è¯•è¦æ±‚

```yaml
testing_requirements:
  unit_tests:
    coverage: ">= 90%"
    description: "å•å…ƒæµ‹è¯•è¦†ç›–ç‡"
    
  integration_tests:
    required: true
    description: "å¿…é¡»åŒ…å«é›†æˆæµ‹è¯•"
    
  security_tests:
    required: true
    description: "å¿…é¡»åŒ…å«å®‰å…¨æµ‹è¯•"
    
  performance_tests:
    required: true
    description: "å¿…é¡»åŒ…å«æ€§èƒ½æµ‹è¯•"
    
  contract_interaction_tests:
    required: true
    description: "å¿…é¡»åŒ…å«åˆçº¦äº¤äº’æµ‹è¯•"
```

## ğŸ“š æ–‡æ¡£çº¦æŸ

### 1. å¿…éœ€æ–‡æ¡£

```yaml
required_documentation:
  - "README.md"
  - "ç»“æ„åŒ–éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦.md"
  - "ç²¾ç¡®æ¥å£å¥‘çº¦.md"
  - "æ¶æ„ä¸è®¾è®¡çº¦æŸ.md"
  - "éåŠŸèƒ½æ€§éœ€æ±‚é‡åŒ–æŒ‡æ ‡.md"
  description: "å¿…é¡»åŒ…å«çš„æ–‡æ¡£"
```

### 2. ä»£ç æ³¨é‡Šè¦æ±‚

```yaml
code_documentation:
  function_comments:
    required: true
    format: "Rust doc comments"
    example: |
      /// åˆ†å‘å¥–åŠ±ç»™ç”¨æˆ·åŠå…¶æ¨èé“¾
      /// 
      /// # Arguments
      /// * `activity_type` - æ´»åŠ¨ç±»å‹
      /// * `user` - ç”¨æˆ·åœ°å€
      /// * `activity_data` - æ´»åŠ¨æ•°æ®
      /// 
      /// # Returns
      /// * `Result<Response, ContractError>` - æ‰§è¡Œç»“æœ
      pub fn distribute_reward(
          activity_type: ActivityType,
          user: Addr,
          activity_data: ActivityData,
      ) -> Result<Response, ContractError> {
          // å®ç°ä»£ç 
      }
    
  struct_comments:
    required: true
    format: "Rust doc comments"
    example: |
      /// å¥–åŠ±è®°å½•ç»“æ„
      #[derive(Serialize, Deserialize, Clone, Debug, PartialEq)]
      pub struct RewardRecord {
          /// æ—¶é—´æˆ³
          pub timestamp: u64,
          /// æ´»åŠ¨ç±»å‹
          pub activity_type: ActivityType,
          /// å¥–åŠ±é‡‘é¢
          pub amount: Uint128,
          /// äº‹ä»¶ID
          pub event_id: Option<String>,
      }
```

## ğŸ”„ ç‰ˆæœ¬æ§åˆ¶çº¦æŸ

### 1. ç‰ˆæœ¬ç®¡ç†

```yaml
version_management:
  semantic_versioning:
    required: true
    format: "MAJOR.MINOR.PATCH"
    description: "å¿…é¡»ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶"
    
  breaking_changes:
    documentation: "å¿…é¡»è®°å½•æ‰€æœ‰ç ´åæ€§å˜æ›´"
    migration_guide: "å¿…é¡»æä¾›è¿ç§»æŒ‡å—"
    
  deprecation_policy:
    notice_period: "è‡³å°‘ä¸€ä¸ªç‰ˆæœ¬å‘¨æœŸ"
    description: "åºŸå¼ƒåŠŸèƒ½å¿…é¡»æå‰é€šçŸ¥"
```

### 2. å…¼å®¹æ€§è¦æ±‚

```yaml
compatibility_requirements:
  backward_compatibility:
    required: true
    description: "å¿…é¡»ä¿æŒå‘åå…¼å®¹æ€§"
    
  forward_compatibility:
    recommended: true
    description: "å»ºè®®ä¿æŒå‘å‰å…¼å®¹æ€§"
    
  api_stability:
    required: true
    description: "APIå¿…é¡»ä¿æŒç¨³å®š"
```

## ğŸ—ï¸ æ¶æ„çº¦æŸ

### 1. åˆçº¦äº¤äº’çº¦æŸ

```yaml
contract_interaction_constraints:
  ft_contract_interaction:
    allowed_operations:
      - "mint"
      - "query_balance"
      - "query_token_info"
    description: "ä¸FTåˆçº¦çš„äº¤äº’é™åˆ¶"
    
  registry_contract_interaction:
    allowed_operations:
      - "allocate_rewards"
      - "query_user_points"
      - "query_referral_chain"
      - "withdraw_points"
    description: "ä¸æ³¨å†Œåˆçº¦çš„äº¤äº’é™åˆ¶"
    
  business_contract_interaction:
    allowed_operations:
      - "distribute_reward"
      - "query_reward_history"
    description: "ä¸ä¸šåŠ¡åˆçº¦çš„äº¤äº’é™åˆ¶"
```

### 2. æ•°æ®æµçº¦æŸ

```yaml
data_flow_constraints:
  reward_calculation_flow:
    steps:
      - "æ¥æ”¶ä¸šåŠ¡äº‹ä»¶"
      - "æŸ¥è¯¢ç”¨æˆ·ç§¯åˆ†"
      - "è®¡ç®—å¥–åŠ±é‡‘é¢"
      - "é“¸é€ ä»£å¸"
      - "åˆ†é…æ¨èå¥–åŠ±"
      - "è®°å½•å¥–åŠ±å†å²"
    description: "å¥–åŠ±è®¡ç®—æ•°æ®æµ"
    
  points_exchange_flow:
    steps:
      - "æ¥æ”¶ç§¯åˆ†å…‘æ¢è¯·æ±‚"
      - "éªŒè¯ç§¯åˆ†æ•°é‡"
      - "æ‰£é™¤ç§¯åˆ†"
      - "é“¸é€ ä»£å¸"
      - "è®°å½•å…‘æ¢å†å²"
    description: "ç§¯åˆ†å…‘æ¢æ•°æ®æµ"
```

## ğŸ“ å˜æ›´è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ | å˜æ›´äºº |
|------|------|----------|--------|
| v1.0 | 2024-01-XX | åˆå§‹çº¦æŸæ–‡æ¡£åˆ›å»º | AI Assistant |

---

**æ³¨æ„**: æœ¬æ–‡æ¡£çº¦æŸAIçš„è®¾è®¡ç©ºé—´ï¼Œç¡®ä¿æŠ€æœ¯æ–¹æ¡ˆç¬¦åˆå›¢é˜Ÿæˆ˜ç•¥ã€å®‰å…¨æ€§å’Œå¯ç»´æŠ¤æ€§è¦æ±‚ã€‚ä»»ä½•æŠ€æœ¯é€‰æ‹©éƒ½å¿…é¡»ç¬¦åˆè¿™äº›çº¦æŸã€‚
